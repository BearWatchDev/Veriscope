<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veriscope - Malware Analysis Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <img src="{{ url_for('static', filename='img/veriscope.png') }}" alt="Veriscope Logo" class="logo-img">
                <div class="logo-text">
                    <pre class="ascii-logo">‚ï¶  ‚ï¶‚îå‚îÄ‚îê‚î¨‚îÄ‚îê‚î¨‚îå‚îÄ‚îê‚îå‚îÄ‚îê‚îå‚îÄ‚îê‚îå‚îÄ‚îê‚îå‚îÄ‚îê
‚ïö‚ïó‚ïî‚ïù‚îú‚î§ ‚îú‚î¨‚îò‚îÇ‚îî‚îÄ‚îê‚îÇ  ‚îÇ ‚îÇ‚îú‚îÄ‚îò‚îú‚î§
 ‚ïö‚ïù ‚îî‚îÄ‚îò‚î¥‚îî‚îÄ‚î¥‚îî‚îÄ‚îò‚îî‚îÄ‚îò‚îî‚îÄ‚îò‚î¥  ‚îî‚îÄ‚îò</pre>
                </div>
            </div>
            <p>Deobfuscate Malware <span class="arrow-icon">‚ñ∂</span> Extract IOCs <span class="arrow-icon">‚ñ∂</span> Generate YARA/Sigma Detection Rules</p>
            <nav>
                <a href="/"><span class="nav-icon nav-icon-large">‚óà</span> Analyze</a>
                <a href="/techniques"><span class="nav-icon nav-icon-large">‚óé</span> ATT&CK Techniques</a>
                <a href="/about"><span class="nav-icon">‚ìò</span> About</a>
            </nav>
        </header>

        <main>
            <div id="upload-section" class="upload-section">
                <h2>Upload File for Analysis</h2>
                <form id="upload-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="file">Select File:</label>
                        <input type="file" id="file" name="file" required>
                        <p class="hint">Supported: .txt, .log, .ps1, .bat, .sh, .js, .vbs, .exe, .dll, .bin (max 100MB)</p>
                    </div>

                    <div class="form-group">
                        <label for="rule_name">Rule Name:</label>
                        <input type="text" id="rule_name" name="rule_name" value="Suspicious_Activity" placeholder="e.g., PhishingCampaign">
                    </div>

                    <div class="form-group">
                        <label for="author">Author:</label>
                        <input type="text" id="author" name="author" value="Veriscope" placeholder="Your name or team">
                    </div>

                    <button type="submit" class="btn-primary">üöÄ Analyze File</button>
                </form>
            </div>

            <!-- New Analysis Button (hidden by default, shown after results) -->
            <div id="new-analysis-btn" style="display: none; text-align: center; margin: 30px auto;">
                <button onclick="resetForNewAnalysis()" class="btn-primary" style="font-size: 1.1em; padding: 15px 40px;">
                    üìÅ Upload New File for Analysis
                </button>
            </div>

            <!-- Progress Section -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Analyzing file... This may take a moment.</p>
            </div>

            <div id="progress-container" class="progress-container" style="display: none;">
                <div class="progress-header">
                    <h3>üîç Deobfuscation Progress</h3>
                    <p id="progress-text">Starting analysis...</p>
                </div>
                <div class="progress-bar-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
                <div class="progress-preview">
                    <code id="progress-preview"></code>
                </div>
            </div>

            <!-- Analysis Results Section -->
            <div id="results" class="results-section" style="display: none;">
                <h2>Analysis Results</h2>

                <div class="summary-cards">
                    <div class="card clickable-card" onclick="showDetailModal('strings')" title="Click for detailed string analysis">
                        <h3>Strings</h3>
                        <p class="stat" id="stat-strings">0</p>
                        <span class="card-hint">Click for details ‚ñ∏</span>
                    </div>
                    <div class="card clickable-card" onclick="showDetailModal('decoded')" title="Click for deobfuscation trace">
                        <h3>Decoded</h3>
                        <p class="stat" id="stat-decoded">0</p>
                        <span class="card-hint">Click for details ‚ñ∏</span>
                    </div>
                    <div class="card clickable-card" onclick="showDetailModal('iocs')" title="Click for IOC breakdown">
                        <h3>IOCs</h3>
                        <p class="stat" id="stat-iocs">0</p>
                        <span class="card-hint">Click for details ‚ñ∏</span>
                    </div>
                    <div class="card clickable-card" onclick="showDetailModal('techniques')" title="Click for ATT&CK mapping">
                        <h3>ATT&CK Techniques</h3>
                        <p class="stat" id="stat-techniques">0</p>
                        <span class="card-hint">Click for details ‚ñ∏</span>
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab-btn active" onclick="showTab('deobfuscation')">‚óà Deobfuscation</button>
                    <button class="tab-btn" onclick="showTab('iocs')">‚óâ IOCs</button>
                    <button class="tab-btn" onclick="showTab('attack')">‚óé ATT&CK</button>
                    <button class="tab-btn" onclick="showTab('yara')">‚óÜ YARA</button>
                    <button class="tab-btn" onclick="showTab('sigma')">‚óá Sigma</button>
                    <button class="tab-btn" onclick="showTab('report')">‚óê Report</button>
                </div>

                <div id="deobfuscation-tab" class="tab-content active">
                    <h3>‚óà Deobfuscation Results</h3>
                    <div id="deobfuscation-content"></div>
                </div>

                <div id="iocs-tab" class="tab-content">
                    <h3>‚óâ Indicators of Compromise</h3>
                    <div id="iocs-content"></div>
                </div>

                <div id="attack-tab" class="tab-content">
                    <h3>‚óé MITRE ATT&CK Techniques</h3>
                    <div id="attack-content"></div>
                </div>

                <div id="yara-tab" class="tab-content">
                    <h3>‚óÜ YARA Detection Rules</h3>
                    <div id="yara-content"></div>
                </div>

                <div id="sigma-tab" class="tab-content">
                    <h3>‚óá Sigma Detection Rules</h3>
                    <div id="sigma-content"></div>
                </div>

                <div id="report-tab" class="tab-content">
                    <h3>‚óê Markdown Report</h3>
                    <div id="report-content"></div>
                    <button onclick="downloadRule('report.md', document.getElementById('report-content').textContent)" class="btn-secondary">Download Report</button>
                </div>
            </div>
        </main>

        <footer>
            <div class="made-with-love">
                Made with <span class="heart">‚ù§</span> for the cybersecurity community
            </div>
            <p>Veriscope v1.3.0 | MIT License | For ethical & defensive security operations only</p>
        </footer>
    </div>

    <!-- Detail Modal -->
    <div id="detail-modal" class="modal" onclick="closeModal(event)" style="display: none;">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modal-title"></h2>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
